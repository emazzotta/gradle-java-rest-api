apply from: "${rootDir}/gradle/groovy.gradle"

ext {
    pomDescription = 'Gradle plugin to generate REST APIs for JAX-RS or Spring-Boot projects'
}

dependencies {

    compile project(':json-model')

    compileOnly gradleApi()
    testCompile gradleTestKit()

    testCompile("org.spockframework:spock-core:${spockVersion}") {
        exclude group: 'org.codehaus.groovy', module: 'groovy-all'
    }

    compile "com.squareup:javapoet:${javaPoetVersion}"
    compile "com.google.guava:guava:${guavaVersion}"
    compile "com.google.code.gson:gson:${gsonVersion}"
}

task checkVersion(type: Test) {
    File file = file("${projectDir}/src/main/groovy/ch/silviowangler/gradle/restapi/RestApiPlugin.groovy")
    String content = file.text

    if (! content.contains("compile(\"ch.silviowangler.rest:rest-api-spring:${version}\")")) {
        throw new RuntimeException("Wrong version in ${file.absolutePath}")
    }
}